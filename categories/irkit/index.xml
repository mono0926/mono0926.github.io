<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Irkit on mono-log</title>
    <link>http://mono0926.com/categories/irkit/</link>
    <description>Recent content in Irkit on mono-log</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Mon, 05 May 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://mono0926.com/categories/irkit/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>IRKitに外からアクセス出来るようにした</title>
      <link>http://mono0926.com/blog/2014/05/05/2014-05-05-irkit-remote/</link>
      <pubDate>Mon, 05 May 2014 00:00:00 +0000</pubDate>
      
      <guid>http://mono0926.com/blog/2014/05/05/2014-05-05-irkit-remote/</guid>
      <description>

&lt;p&gt;前回の&lt;a href=&#34;http://mono0926.com/blog/2014/05/05/irkit/&#34;&gt;IRKitで遊び始めた〜とりあえずTerminalで操作〜 - monoHub&lt;/a&gt;の続き。&lt;/p&gt;

&lt;p&gt;前回触った&lt;a href=&#34;http://getirkit.com/#IRKit-Device-API&#34;&gt;IRKit Device HTTP API&lt;/a&gt;は同じWiFi内から操作するためのもので、外からアクセスするときは&lt;a href=&#34;http://getirkit.com/#IRKit-Internet-API&#34;&gt;IRKit Internet HTTP API&lt;/a&gt;を叩くことになる。&lt;/p&gt;

&lt;h2 id=&#34;irkit-internet-http-apiを叩けるように準備:5d8e90fe8a0a2368638010d84e1be72c&#34;&gt;IRKit Internet HTTP APIを叩けるように準備&lt;/h2&gt;

&lt;p&gt;まずは、clienttokenを取得。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Pro:~ mono$ curl -i http://192.168.0.4/keys -d &#39;&#39;
HTTP/1.0 200 OK
Access-Control-Allow-Origin: *
Server: IRKit/1.3.5.0.gce6ac15
Content-Type: text/plain

{&amp;quot;clienttoken&amp;quot;:&amp;quot;**************************&amp;quot;} #伏せています
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;取得したclienttokenを元に、deviceidとclientkeyを取得。&lt;/p&gt;

&lt;!-- more --&gt;

&lt;pre&gt;&lt;code&gt;Pro:~ mono$ curl -i -d &amp;quot;clienttoken=**************************&amp;quot; &amp;quot;https://api.getirkit.com/1/keys&amp;quot;
HTTP/1.1 200 OK
Server: ngx_openresty
Date: Mon, 05 May 2014 06:44:32 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 94
Connection: keep-alive
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: X-Requested-With
X-Content-Type-Options: nosniff

{&amp;quot;deviceid&amp;quot;:&amp;quot;XXXXXXXXXXXXXXXXXXXXXX&amp;quot;,&amp;quot;clientkey&amp;quot;:&amp;quot;YYYYYYYYYYYYYYYYYYYYY&amp;quot;} #伏せています
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;internet-http-apiを使ってみる:5d8e90fe8a0a2368638010d84e1be72c&#34;&gt;Internet HTTP APIを使ってみる&lt;/h2&gt;

&lt;p&gt;deviceid・clientkey・家のライトのオンオフ信号を&lt;a href=&#34;https://api.getirkit.com/1/messages&#34;&gt;https://api.getirkit.com/1/messages&lt;/a&gt; にポストすると、ちゃんと反応した、素晴らしい(　´･‿･｀)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -i &amp;quot;https://api.getirkit.com/1/messages&amp;quot; \
     -d &#39;clientkey=YYYYYYYYYYYYYYYYYYYYY&#39; \
     -d &#39;deviceid=XXXXXXXXXXXXXXXXXXXXXX&#39; \
     -d &#39;message={&amp;quot;format&amp;quot;:&amp;quot;raw&amp;quot;,&amp;quot;freq&amp;quot;:38,&amp;quot;data&amp;quot;:[17421,9061,1037,1232,935,3458,935,1190,1073,1190,1073,1190,1190,1190,1073,1190,935,3458,1037,3341,1037,1190,935,3458,1002,3458,1002,1111,1111,3341,968,3458,968,1150,1150,3458,1037,3341,1037,1275,1002,3458,1002,1190,1037,3341,1037,1150,1150,3341,1037,1190,935,1275,935,3458,1037,1190,1002,3458,1037,1232,935,3458,1111,1111,1111]}&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;上記操作で、IRKitサーバーがIRKit端末にアクセス出来るようになって、認証すれば外部から操作出来るようになるって感じかなあ。
特に、deviceid・clientkeyは漏れるとまずいですね（´-ω-｀）&lt;/p&gt;

&lt;h2 id=&#34;ついでにapikeyを取得:5d8e90fe8a0a2368638010d84e1be72c&#34;&gt;ついでにapiKeyを取得&lt;/h2&gt;

&lt;p&gt;iPhoneアプリを作ったりするのに使う用のkeyを取得するAPIもあったので、ついでに叩いてみた。
入力したメールアドレスに確認メールが来て、無事にapiKeyゲット。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Pro:~ mono$ curl -i -d &amp;quot;email=xxxxxx@gmail.com&amp;quot; &amp;quot;https://api.getirkit.com/1/apps&amp;quot;
HTTP/1.1 200 OK
Server: ngx_openresty
Date: Mon, 05 May 2014 07:00:31 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 92
Connection: keep-alive
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: X-Requested-With
X-Content-Type-Options: nosniff
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;このapiKitと&lt;a href=&#34;https://github.com/irkit/ios-sdk&#34;&gt;irkit/ios-sdk&lt;/a&gt;でiPhoneアプリ簡単に作れるみたいだけど、&lt;a href=&#34;https://github.com/irkit/ios-sdk&#34;&gt;irkit/ios-sdk&lt;/a&gt;とかでけっこう充分だったりするし、どうしよう（´-ω-｀）&lt;br /&gt;
やるならiBeaconと組み合わせたいけど、手軽で安いのがまだない感じ（´-ω-｀）&lt;br /&gt;
&lt;a href=&#34;http://estimote.com/&#34;&gt;Estimote Beacons — real world context for your apps&lt;/a&gt;は洗練されてる感じだけど、$99/3個と割高感が否めない（´-ω-｀）&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>